<div class="exercise-page">
  <h2>ðŸ§  Exercices pratiques</h2>
  <p>Choisissez un mode :</p>

  <!-- BOUTONS DE MODE -->
  <div class="btn-group">
    <button (click)="start('spelling')"   class="primary-btn">Orthographe</button>
    <button (click)="start('grammar')"    class="primary-btn">Grammaire</button>
    <button (click)="start('correction')" class="primary-btn">Auto-correction</button>
  </div>
  <hr />

  <!-- LORSQU'UN MODE EST ACTIF -->
  <div *ngIf="mode">
    <!-- BOUTONS DE TYPE D'EXERCICE -->
    <div class="btn-group type-group">
      <button
        *ngFor="let ex of exercises[mode]; let i = index"
        (click)="selectType(i)"
        [class.active]="i === typeIndex"
        class="primary-btn small"
      >
        {{ ex.title }}
      </button>
    </div>

    <!-- SUIVI DE PROGRÃˆS -->
    <p class="tracker">
      Type {{ typeIndex + 1 }} / {{ totalTypes }} â€”
      Exemple {{ exampleIndex + 1 }} / {{ totalExamples }}
    </p>

    <div class="exercise-block">
      <!-- AFFICHAGE SELON LE TYPE D'EXERCICE -->
      <ng-container [ngSwitch]="currentExercise.type">
        <!-- Remettre en ordre -->
        <div *ngSwitchCase="'unscramble'">
          <p>{{ currentExercise.title }} :</p>
          <h3>{{ currentExample.scrambled }}</h3>
          <input [(ngModel)]="userInput" placeholder="Tapez votre rÃ©ponse ici" />
        </div>

        <!-- Choix multiples -->
        <div *ngSwitchCase="'multipleChoice'">
          <p>{{ currentExercise.title }} :</p>
          <div *ngFor="let opt of currentExample.options">
            <label>
              <input
                type="radio"
                name="mc"
                [(ngModel)]="userInput"
                [value]="opt"
              />
              {{ opt }}
            </label>
          </div>
        </div>

        <!-- Remplir les blancs -->
        <div *ngSwitchCase="'fillBlank'">
          <p>{{ currentExercise.title }} :</p>
          <p class="blank">{{ currentExample.template }}</p>
          <input [(ngModel)]="userInput" placeholder="ComplÃ©tez ici" />
        </div>

        <!-- Corriger la phrase -->
        <div *ngSwitchCase="'fixSentence'">
          <p>{{ currentExercise.title }} :</p>
          <blockquote>{{ currentExample.original }}</blockquote>
          <input [(ngModel)]="userInput" placeholder="Votre correction" />
        </div>

        <!-- Trouver le mot incorrect -->
        <div *ngSwitchCase="'identifyWrongWord'">
          <p>{{ currentExercise.title }} :</p>
          <div class="word-list">
            <button
              *ngFor="let w of currentExample.sentenceWords; let idx = index"
              (click)="checkClick(idx)"
              class="word-btn"
            >
              {{ w }}
            </button>
          </div>
        </div>

        <!-- Choisir le bon mot -->
        <div *ngSwitchCase="'chooseWord'">
          <p>{{ currentExercise.title }} :</p>
          <p>{{ currentExample.sentenceTemplate }}</p>
          <div *ngFor="let opt of currentExample.options">
            <label>
              <input
                type="radio"
                name="cw"
                [(ngModel)]="userInput"
                [value]="opt"
              />
              {{ opt }}
            </label>
          </div>
        </div>

        <!-- Cliquer sur la mauvaise orthographe -->
        <div *ngSwitchCase="'clickSpelling'">
          <p>{{ currentExercise.title }} :</p>
          <div class="word-list">
            <button
              *ngFor="let w of currentExample.sentenceWords; let idx = index"
              (click)="checkClick(idx)"
              class="word-btn"
            >
              {{ w }}
            </button>
          </div>
        </div>

        <!-- RÃ©Ã©crire la phrase -->
        <div *ngSwitchCase="'rewriteSentence'">
          <p>{{ currentExercise.title }} :</p>
          <blockquote>{{ currentExample.original }}</blockquote>
          <input [(ngModel)]="userInput" placeholder="RÃ©Ã©crivez ici" />
        </div>

        <!-- Cliquer sur l'homophone incorrect -->
        <div *ngSwitchCase="'clickHomophone'">
          <p>{{ currentExercise.title }} :</p>
          <div class="word-list">
            <button
              *ngFor="let w of currentExample.sentenceWords; let idx = index"
              (click)="checkClick(idx)"
              class="word-btn"
            >
              {{ w }}
            </button>
          </div>
        </div>
      </ng-container>

      <!-- BOUTON VÃ‰RIFIER (pour les types non-cliquables) -->
      <button
        *ngIf="['unscramble','multipleChoice','fillBlank','fixSentence','chooseWord','rewriteSentence'].includes(currentExercise.type)"
        class="primary-btn"
        (click)="checkAnswer()"
      >
        VÃ©rifier
      </button>

      <p class="feedback">{{ result }}</p>

      <!-- EXEMPLE SUIVANT -->
      <button
        *ngIf="exampleIndex < totalExamples - 1"
        class="primary-btn small"
        (click)="nextExample()"
      >
        Exemple suivant
      </button>
    </div>
  </div>
</div>
